import requests, re
import matplotlib.pyplot as plt
from bs4 import BeautifulSoup
from charts.chart import Chart

class ExtChart(Chart):

    def show(self, data, show=True):
        print('file ext')
        exts = [x[1].split('.')[-1] for x in data if x[1] != '-']
        results = {ext:exts.count(ext) for ext in exts}

        results = {k: results[k] for k in sorted(results.keys(), key=lambda x: results[x])[-10:]}
        plt.bar(range(0,len(results)), results.values())
        plt.xlabel('File types')
        plt.ylabel('Amount of incidents')
        plt.title('Amount of incidents per file extension')
        plt.xticks(range(0, len(results)), results.keys())
        if show:
            plt.show()
        else:
            plt.savefig('charts/results/file_types.png')
        plt.close()
