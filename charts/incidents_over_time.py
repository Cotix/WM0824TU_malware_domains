import datetime
import matplotlib.pyplot as plt

def show(data, cummelative=True, show=True):
    start = datetime.datetime(2009, 3, 22)
    results = []
    labels = []
    tmp = 0
    for i in data:
        while ((i[0]-start).days >= 1):
            labels.append(start)
            results.append(tmp)
            start += datetime.timedelta(days=1)
            if not cummelative:
                tmp = 0
        tmp += 1

    plt.plot(labels, results)
    plt.ylabel('Amount of malicious domains found')
    if show:
        plt.show()
    else:
        plt.savefig('charts/results/incidents_over_time.png')
    plt.close()
